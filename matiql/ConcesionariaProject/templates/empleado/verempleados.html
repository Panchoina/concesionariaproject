{% extends 'Index.html' %}
{% load static %}



{% block contenido %}
    <nav class="navbar bg-body-tertiary fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Bienvenido, {{ user.username }}</a>
            
            <a class="navbar-brand" href="{% url 'VenderAuto' %}">Vender un auto</a>
            <!-- parte administrativa -->
            <a class="navbar-brand" href="{% url 'crearempleado' %}">Agregar un administrador</a>
            <a class="navbar-brand" href="{% url 'listar' %}">Ver los administradores agregados</a>
            
            <!-- Botón Cerrar Sesión -->
            <a class="btn btn-danger" href="{% url 'login' %}">
                <svg class="bi bi-box-arrow-left" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0z" />
                    <path
                        d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708z" />
                </svg>
                Cerrar Sesión
            </a>

            <div class="collapse navbar-collapse">
                
            </div>
        </div>
    </nav>
    <CEnter><div class="container" style="margin-top: 5%;">
        <div class="card card-body">
            <h1>Empleados Administrativos</h1>
            <table class="table table-bordered table-hover ">
                <thead class="table-primary">
                    <tr>
                        <th>Run</th>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>direccion</th>
                        <th>FonoEmpleado</th>
                        <th>gmail</th>
                        <th>area</th>
                        <th>contraseña</th>
                        <th>FechaNacimiento</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in lista %}
                    <tr>
                        <td>{{ item.rut }}</td>
                        <td>{{ item.nombre }}</td>
                        <td>{{ item.apellido }}</td>
                        <td>{{ item.direccion }}</td>
                        <td>{{ item.FonoEmpleado }}</td>
                        <td>{{ item.gmail }}</td>
                        <td>{{ item.area }}</td>
                        <td>{{ item.contraseña }}</td>
                        <td>{{ item.FechaNacimiento }}</td>
                        <td nowrap>
                            <a href="{% url 'actualizar_empleados' item.rut %}" class="btn btn-warning">Editar</a>
                            <a href="#" onclick="eliminar('{{ item.rut }}')" class="btn btn-danger">Eliminar</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div></CEnter>
    <script>
        const eliminar = (id) => {
            Swal.fire({
                title: "¿Está seguro de eliminar el empleado?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#d33",
                cancelButtonColor: "#3085d6",
                confirmButtonText: "Eliminar"
            }).then((result) => {
                if (result.isConfirmed)
                    window.location.href = '/empleado/verempleado/' + id
            })
        }
        //función para exportar los datos a excel
        const exportar = () => {
    
            //capturamos el id del cargo seleccionado
            let cargo = document.getElementById('id_cargos').value
            //si el cargo es vacio lo cambia por un 0
            if(cargo == '')
                cargo = 0
            //url para descargar el excel
            const url = '/empleado/exportexcel/' + cargo
            //abre en otra ventana el archivo a descargar
            open(url,'_self')
        }
    </script>
{% endblock contenido %}
    